#!/bin/bash

#check args
if [ -z "$1" ]; then
    echo "Usage: $0 <filename>"
    exit 1
fi

#set file to arg
file="$1"

#Look for embedded flags '{'
echo "Strings with '{' from the file:"
strings "$file" | grep '{'

#get file type information
echo -e "\nFile type information:"
file "$file" | tr "," "\n"

#check security settings of the file
echo -e "\nSecurity checks (checksec):"
pwn checksec "$file"

#analyze the binary
echo -e "\nFile information using rabin2:"
rabin2 -I "$file"

#search for strings and exclude specific patterns
echo -e "\nStrings without imports and specific values:"
rabin2 -qs "$file" | grep -ve imp -e ' 0 '

#analyze symbol table
echo -e "\nSymbol table analysis:"
rabin2 -z "$file"

#list functions in the file with 't' in their type (text section symbols)
echo -e "\nFunctions (text section) in the file:"
nm "$file" | grep ' t '

#print the full import table information
echo -e "\nFull import table info using rabin2:"
rabin2 -i "$file"

#print the realocations using rabin
echo -e "\nRealocations of the binary using rabin2:"
rabin2 -R "$file"
